# SPDX-License-Identifier: GPL-2.0
#
# Makefile for the linux kernel.
#

ifneq ($(CONFIG_PVR_RGX), )
ccflags-y += \
	-D__linux__ \
	-include $(srctree)/drivers/gpu/rgx/config_kernel_j721e.h \
	-Idrivers/gpu/rgx/include \
	-Idrivers/gpu/rgx/services/server/include \
	-Idrivers/gpu/rgx/kernel/drivers/staging/imgtec \
	-Idrivers/gpu/rgx/include/public \
	-Idrivers/gpu/rgx/services/include \
	-Idrivers/gpu/rgx/services/include/shared \
	-Idrivers/gpu/rgx/services/shared/include \
	-Idrivers/gpu/rgx/hwdefs \
	-Idrivers/gpu/rgx/hwdefs/km \
	-Idrivers/gpu/rgx/services/system/rgx_j721e \
	-Idrivers/gpu/rgx/services/system/include \
	-Idrivers/gpu/rgx/services/include/env/linux \
	-Idrivers/gpu/rgx/services/server/devices/rgx \
	-Idrivers/gpu/rgx/include/drm \
	-Idrivers/gpu/rgx/services/server/env/linux \
	-Idrivers/gpu/rgx/services/shared/devices/rgx \
	-Idrivers/gpu/rgx/generated/mm_bridge \
	-Idrivers/gpu/rgx/generated/cmm_bridge \
	-Idrivers/gpu/rgx/generated/srvcore_bridge \
	-Idrivers/gpu/rgx/generated/sync_bridge \
	-Idrivers/gpu/rgx/generated/htbuffer_bridge \
	-Idrivers/gpu/rgx/generated/pvrtl_bridge \
	-Idrivers/gpu/rgx/generated/cache_bridge \
	-Idrivers/gpu/rgx/generated/dmabuf_bridge \
	-Idrivers/gpu/rgx/generated/rgxtq_bridge \
	-Idrivers/gpu/rgx/generated/rgxtq2_bridge \
	-Idrivers/gpu/rgx/generated/rgxta3d_bridge \
	-Idrivers/gpu/rgx/generated/rgxhwperf_bridge \
	-Idrivers/gpu/rgx/generated/rgxkicksync_bridge \
	-Idrivers/gpu/rgx/generated/rgxcmp_bridge \
	-Idrivers/gpu/rgx/generated/rgxray_bridge \
	-Idrivers/gpu/rgx/generated/breakpoint_bridge \
	-Idrivers/gpu/rgx/generated/regconfig_bridge \
	-Idrivers/gpu/rgx/generated/timerquery_bridge \
	-Idrivers/gpu/rgx/generated/debugmisc_bridge \
	-Idrivers/gpu/rgx/generated/rgxsignals_bridge \
	-Idrivers/gpu/rgx/generated/ri_bridge \
	-Idrivers/gpu/rgx/generated/devicememhistory_bridge \
	-Idrivers/gpu/rgx/generated/synctracking_bridge \
	-Idrivers/gpu/rgx/generated/mm_bridge \
	-Idrivers/gpu/rgx/generated/sync_bridge \
	-Idrivers/gpu/rgx/generated/htbuffer_bridge \
	-Idrivers/gpu/rgx/generated/cache_bridge \
	-Idrivers/gpu/rgx/generated/pvrtl_bridge \
	-Idrivers/gpu/rgx/generated/ri_bridge \
	-Idrivers/gpu/rgx/generated/devicememhistory_bridge \
	-Idrivers/gpu/rgx/generated/synctracking_bridge \

endif

rgxsrvkm-y += \
	services/server/env/linux/event.o \
	services/server/env/linux/km_apphint.o \
	services/server/env/linux/module_common.o \
	services/server/env/linux/osmmap_stub.o \
	services/server/env/linux/osfunc.o \
	services/server/env/linux/allocmem.o \
	services/server/env/linux/osconnection_server.o \
	services/server/env/linux/pdump.o \
	services/server/env/linux/physmem_osmem_linux.o \
	services/server/env/linux/pmr_os.o \
	services/server/env/linux/pvr_debugfs.o \
	services/server/env/linux/pvr_bridge_k.o \
	services/server/env/linux/pvr_debug.o \
	services/server/env/linux/physmem_dmabuf.o \
	services/server/common/devicemem_heapcfg.o \
	services/shared/common/devicemem.o \
	services/shared/common/devicemem_utils.o \
	services/shared/common/hash.o \
	services/shared/common/ra.o \
	services/shared/common/sync.o \
	services/shared/common/mem_utils.o \
	services/server/common/devicemem_server.o \
	services/server/common/handle.o \
	services/server/common/lists.o \
	services/server/common/mmu_common.o \
	services/server/common/connection_server.o \
	services/server/common/physheap.o \
	services/server/common/physmem.o \
	services/server/common/physmem_lma.o \
	services/server/common/physmem_hostmem.o \
	services/server/common/physmem_tdsecbuf.o \
	services/server/common/pmr.o \
	services/server/common/power.o \
	services/server/common/process_stats.o \
	services/server/common/pvr_notifier.o \
	services/server/common/pvrsrv.o \
	services/server/common/srvcore.o \
	services/server/common/sync_checkpoint.o \
	services/server/common/sync_server.o \
	services/shared/common/htbuffer.o \
	services/server/common/htbserver.o \
	services/server/env/linux/htb_debug.o \
	services/server/common/tlintern.o \
	services/shared/common/tlclient.o \
	services/server/common/tlserver.o \
	services/server/common/tlstream.o \
	services/server/common/cache_km.o \
	services/shared/common/uniq_key_splay_tree.o \
	services/server/common/pvrsrv_pool.o \
	services/server/common/pvrsrv_bridge_init.o \
	services/server/common/info_page_km.o \
	kernel/drivers/staging/imgtec/pvr_platform_drv.o \
	services/server/devices/rgx/debugmisc_server.o \
	services/server/devices/rgx/rgxbreakpoint.o \
	services/server/devices/rgx/rgxccb.o \
	services/server/devices/rgx/rgxdebug.o \
	services/server/devices/rgx/rgxfwutils.o \
	services/server/devices/rgx/rgxinit.o \
	services/server/devices/rgx/rgxbvnc.o \
	services/server/devices/rgx/rgxkicksync.o \
	services/server/devices/rgx/rgxlayer_impl.o \
	services/server/devices/rgx/rgxmem.o \
	services/server/devices/rgx/rgxmmuinit.o \
	services/server/devices/rgx/rgxregconfig.o \
	services/server/devices/rgx/rgxta3d.o \
	services/server/devices/rgx/rgxsyncutils.o \
	services/server/devices/rgx/rgxtimerquery.o \
	services/server/devices/rgx/rgxtransfer.o \
	services/server/devices/rgx/rgxtdmtransfer.o \
	services/server/devices/rgx/rgxutils.o \
	services/shared/devices/rgx/rgx_compat_bvnc.o \
	services/server/devices/rgx/rgxmipsmmuinit.o \
	services/server/devices/rgx/rgxhwperf.o \
	services/server/devices/rgx/rgxpower.o \
	services/server/devices/rgx/rgxstartstop.o \
	services/server/devices/rgx/rgxtimecorr.o \
	services/server/devices/rgx/rgxcompute.o \
	services/server/devices/rgx/rgxray.o \
	services/server/devices/rgx/rgxsignals.o \
	services/server/env/linux/handle_idr.o \
	kernel/drivers/staging/imgtec/pvr_sync_file.o \
	kernel/drivers/staging/imgtec/pvr_counting_timeline.o \
	kernel/drivers/staging/imgtec/pvr_sw_fence.o \
	kernel/drivers/staging/imgtec/pvr_fence.o \
	services/server/env/linux/dma_fence_sync_native_server.o \
	services/server/env/linux/osfunc_arm64.o \
	services/server/env/linux/trace_events.o \
	kernel/drivers/staging/imgtec/pvr_drm.o \
	services/server/devices/rgx/rgxsrvinit.o \
	services/server/devices/rgx/rgxfwimageutils.o \
	services/shared/devices/rgx/rgx_hwperf_table.o \
	services/server/devices/rgx/env/linux/km/rgxfwload.o \
	generated/mm_bridge/server_mm_bridge.o \
	generated/cmm_bridge/server_cmm_bridge.o \
	generated/srvcore_bridge/server_srvcore_bridge.o \
	generated/sync_bridge/server_sync_bridge.o \
	generated/htbuffer_bridge/server_htbuffer_bridge.o \
	generated/pvrtl_bridge/server_pvrtl_bridge.o \
	generated/cache_bridge/server_cache_bridge.o \
	generated/dmabuf_bridge/server_dmabuf_bridge.o \
	generated/rgxtq_bridge/server_rgxtq_bridge.o \
	generated/rgxtq2_bridge/server_rgxtq2_bridge.o \
	generated/rgxta3d_bridge/server_rgxta3d_bridge.o \
	generated/rgxhwperf_bridge/server_rgxhwperf_bridge.o \
	generated/rgxkicksync_bridge/server_rgxkicksync_bridge.o \
	generated/rgxcmp_bridge/server_rgxcmp_bridge.o \
	generated/rgxray_bridge/server_rgxray_bridge.o \
	generated/breakpoint_bridge/server_breakpoint_bridge.o \
	generated/regconfig_bridge/server_regconfig_bridge.o \
	generated/timerquery_bridge/server_timerquery_bridge.o \
	generated/debugmisc_bridge/server_debugmisc_bridge.o \
	generated/rgxsignals_bridge/server_rgxsignals_bridge.o \
	generated/mm_bridge/client_mm_direct_bridge.o \
	generated/sync_bridge/client_sync_direct_bridge.o \
	generated/htbuffer_bridge/client_htbuffer_direct_bridge.o \
	generated/cache_bridge/client_cache_direct_bridge.o \
	generated/pvrtl_bridge/client_pvrtl_direct_bridge.o \
	services/system/rgx_j721e/sysconfig.o \
	services/system/common/env/linux/interrupt_support.o \
	services/system/common/env/linux/dma_support.o \
	services/system/common/vz_physheap_generic.o \
	services/system/common/vz_physheap_common.o \
	services/system/common/vmm_pvz_client.o \
	services/system/common/vmm_pvz_server.o \
	services/system/common/vz_vmm_pvz.o \
	services/system/common/vz_vmm_vm.o \
	services/system/common/vz_support.o \
	services/system/common/vmm_type_stub.o \

obj-$(CONFIG_PVR_RGX) += rgxsrvkm.o
