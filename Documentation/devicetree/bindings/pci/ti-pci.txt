TI PCI Controllers

PCIe DesignWare Controller
 - compatible: Should be "ti,dra7-pcie" for RC
	       Should be "ti,dra7-pcie-ep" for EP
 - phys : list of PHY specifiers (used by generic PHY framework)
 - phy-names : must be "pcie-phy0", "pcie-phy1", "pcie-phyN".. based on the
	       number of PHYs as specified in *phys* property.
 - ti,hwmods : Name of the hwmod associated to the pcie, "pcie<X>",
	       where <X> is the instance number of the pcie from the HW spec.
 - num-lanes as specified in ../designware-pcie.txt

HOST MODE
=========
 - reg : Two register ranges as listed in the reg-names property
 - reg-names : The first entry must be "ti-conf" for the TI-specific registers
	       The second entry must be "rc-dbics" for the DesignWare PCIe
	       registers
	       The third entry must be "config" for the PCIe configuration space
 - interrupts : Two interrupt entries must be specified. The first one is for
		main interrupt line and the second for MSI interrupt line.
 - #address-cells,
   #size-cells,
   #interrupt-cells,
   device_type,
   ranges,
   interrupt-map-mask,
   interrupt-map : as specified in ../designware-pcie.txt

DEVICE MODE
===========
 - reg : Four register ranges as listed in the reg-names property
 - reg-names : "ti-conf" for the TI-specific registers
	       "ep_dbics" for the standard configuration registers as
		they are locally accessed within the DIF CS space
	       "ep_dbics2" for the standard configuration registers as
		they are locally accessed within the DIF CS2 space
	       "addr_space" used to map remote RC address space
 - interrupts : one interrupt entries must be specified for main interrupt.
 - num-ib-windows : number of inbound address translation windows
 - num-ob-windows : number of outbound address translation windows
 - ti,syscon-unaligned-access: phandle to the syscon DT node. The 1st argument
			       should contain the register offset within syscon
			       and the 2nd argument should contain the bit field
			       for setting the bit to enable unaligned
			       access.

Optional Property:
 - gpios : Should be added if a GPIO line is required to drive PERST# line

NOTE: Two DT nodes may be added for each PCI controller; one for host
mode and another for device mode. So in order for PCI to
work in host mode, EP mode DT node should be disabled and in order to PCI to
work in EP mode, host mode DT node should be disabled. Host mode and EP
mode are mutually exclusive.

Example:
axi {
	compatible = "simple-bus";
	#size-cells = <1>;
	#address-cells = <1>;
	ranges = <0x51000000 0x51000000 0x3000
		  0x0	     0x20000000 0x10000000>;
	pcie@51000000 {
		compatible = "ti,dra7-pcie";
		reg = <0x51000000 0x2000>, <0x51002000 0x14c>, <0x1000 0x2000>;
		reg-names = "rc_dbics", "ti_conf", "config";
		interrupts = <0 232 0x4>, <0 233 0x4>;
		#address-cells = <3>;
		#size-cells = <2>;
		device_type = "pci";
		ranges = <0x81000000 0 0          0x03000 0 0x00010000
			  0x82000000 0 0x20013000 0x13000 0 0xffed000>;
		#interrupt-cells = <1>;
		num-lanes = <1>;
		ti,hwmods = "pcie1";
		phys = <&pcie1_phy>;
		phy-names = "pcie-phy0";
		interrupt-map-mask = <0 0 0 7>;
		interrupt-map = <0 0 0 1 &pcie_intc 1>,
				<0 0 0 2 &pcie_intc 2>,
				<0 0 0 3 &pcie_intc 3>,
				<0 0 0 4 &pcie_intc 4>;
		pcie_intc: interrupt-controller {
			interrupt-controller;
			#address-cells = <0>;
			#interrupt-cells = <1>;
		};
	};
};

PCI Controller in DRA8:
 - compatible: Should be "ti,k3-dra8-pcie"
 - reg : Two register ranges as listed in the reg-names property
 - reg-names : The first entry must be "intd_cfg" used for handling legacy
     interrupts. The second entry must be "user_cfg" and it has registers
     for enabling the LTSSM
 - #address-cells : should be 1 to indicate the child node should use 1 cell
     for address
 - #size-cells : should be 1 to indicate the child node should use 1 cell for
     size
 - #interrupt-cells : should be 1 to indicate interrupt-map has 1 cell for
     interrupt
 - interrupt-map-mask : As mentioned in "Open Firmware Recommended Practice:
     Interrupt Mapping" document
 - interrupt-map : As mentioned in "Open Firmware Recommended Practice:
     Interrupt Mapping" document
 - mode : should be <PCI_MODE_RC> for RC mode and should be <PCI_MODE_EP> for
     EP mode

It should have two child nodes, one for RC mode (pcie) and the other for EP
mode (pcie-ep). The child node for RC should follow the binding in
cdns,cdns-pcie-host.txt. The child node for the EP should follow the binding
in cdns,cdns-pcie-ep.txt

It should also have an interrupt controller device node
(legacy-interrupt-controller) for Legacy IRQ chip with the following properties
 - interrupt-controller: To indicate this is an interrupt controller dt node
 - interrupt-cells: should be set to 1
 - interrupt-parent: Parent interrupt controller phandle
 - interrupts: GIC interrupt lines connected to PCI Legacy interrupt lines

Example:
	pcie0: pcie@2900000 {
		compatible = "ti,k3-dra8-pcie";
		reg = <0x02900000 0x1000>,
		      <0x02907000 0x400>;
		reg-names = "intd_cfg", "user_cfg";
		#address-cells = <1>;
		#size-cells = <1>;
		ranges;
		#interrupt-cells = <1>;
		interrupt-map-mask = <0 7>;
		interrupt-map = <0 1 &pcie0_intc 0>, /* INT A */
				<0 2 &pcie0_intc 0>, /* INT B */
				<0 3 &pcie0_intc 0>, /* INT C */
				<0 4 &pcie0_intc 0>; /* INT D */
		status = "disabled";

		pcie0_rc: pcie@d000000 {
			compatible = "cdns,cdns-pcie-host";
			reg = <0x0d000000 0x00800000>,
			      <0x10000000 0x00001000>,
			      <0x10000000 0x08000000>;
			reg-names = "reg", "cfg", "mem";
			device_type = "pci";
			#address-cells = <3>;
			#size-cells = <2>;
			bus-range = <0x0 0xff>;
			linux,pci-domain = <0>;
			cdns,max-outbound-regions = <16>;
			cdns,no-bar-match-nbits = <32>;
			vendor-id = /bits/ 16 <0x17cd>;
			device-id = /bits/ 16 <0x0200>;
			msi-map = <0x0 &gic_its 0x0 0x1000>;
			ranges = <0x01000000 0x0 0x10001000  0x10001000  0x0 0x0010000>,
				 <0x02000000 0x0 0x10011000  0x10011000  0x0 0x7fef000>;
		};

		pcie0_ep: pcie-ep@d000000 {
			compatible = "cdns,cdns-pcie-ep";
			reg = <0x0d000000 0x00800000>,
			      <0x10000000 0x08000000>;
			reg-names = "reg", "mem";
			cdns,max-outbound-regions = <16>;
			max-functions = /bits/ 8 <2>;
		};

		pcie0_intc: legacy-interrupt-controller {
			interrupt-controller;
			#interrupt-cells = <1>;
			interrupt-parent = <&gic500>;
			interrupts = <GIC_SPI 312 IRQ_TYPE_EDGE_RISING>;
		};
	};
